@page "/{Activity_ID:int}/Participants"
@using Eventify.Data
@inject ApplicationDbContext db
@layout Eventify.Components.Layout.MainLayout

<PageTitle>Participants</PageTitle>

<div style="width:100%;height:100%;display:flex;flex-direction:column;justify-content:start;align-items:start;padding:2rem;box-sizing:border-box;">
    <div class="judgingsheet-header">
        <img src="activityIcon.png" style="" />
        <h1 style="">@(($"{Activity.Name}").ToUpper())</h1>
        <div style="">
            <p>@Activity.Venue</p>
            <p>@Activity.StartTime - @Activity.EndTime</p>
        </div>
    </div>
    <div style="width:100%;height:auto;display:flex;flex-direction:row;flex-wrap:wrap;padding:2rem;box-sizing:border-box;">
        @foreach (var peep in Participants)
        {
            <a href="@($"{Activity.Id}/Judging/{peep.Id}")" style="display:flex;flex-direction:row;justify-content:center;align-items:center;border:1px solid black; padding:2rem;display:inline-block;margin:0 1rem 1rem 0;">
                <img src="participantIcon.png"/>
                <span>@peep.EntryNumber</span>
            </a>
        }
    </div>
</div>

@code{
    [Parameter]
    public int? Activity_ID { get; set; }
    [Parameter]
    public Activity? Activity { get; set; } = new();

    List<Participants>? Participants = new();

    protected override void OnInitialized()
    {
        Activity = db.Activity.Single(i => i.Id == Activity_ID);
        GetParticipants();
    }

    void GetParticipants()
    {
        var participants = from peeps in db.Participants
                           where peeps.ActivityID == Activity.Id
                           select peeps;
        
        Participants = participants.ToList();
    }
}
